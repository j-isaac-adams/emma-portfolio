<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="contact.css" />
    <link
      rel="stylesheet"
      href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"
    />
    <title>Emma Huber - Contact</title>
    <link rel="icon" href="../assets/favicon.ico" type="image/x-icon" />
  </head>
  <body>
    <div v-scope="contactApp()">
      <!-- Back Button -->
      <a href="../home" class="back-button">
        <svg
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          xmlns="http://www.w3.org/2000/svg"
        >
          <path
            d="M19 12H5M5 12L12 19M5 12L12 5"
            stroke="currentColor"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          />
        </svg>
        <span>Back</span>
      </a>

      <!-- Main Container -->
      <div class="page-wrapper">
        <div class="container contact-page">
          <div class="text-zone">
            <h1 class="page-title">Contact Me</h1>
            <p class="intro-text">
              I am interested in freelance opportunities, part-time positions,
              and internships. Please reach out if you feel I would be a good
              fit for your project or team, or if you have any questions.
            </p>

            <!-- Contact Form -->
            <div class="contact-form">
              <form @submit.prevent="sendEmail">
                <ul>
                  <li class="half">
                    <input
                      v-model="formData.name"
                      placeholder="Name"
                      type="text"
                      name="name"
                      required
                    />
                  </li>
                  <li class="half">
                    <input
                      v-model="formData.email"
                      placeholder="Email"
                      type="email"
                      name="email"
                      required
                    />
                  </li>
                  <li>
                    <input
                      v-model="formData.subject"
                      placeholder="Subject"
                      type="text"
                      name="subject"
                      required
                    />
                  </li>
                  <li>
                    <textarea
                      v-model="formData.message"
                      placeholder="Message"
                      name="message"
                      required
                    ></textarea>
                  </li>
                  <li>
                    <button
                      type="submit"
                      class="flat-button"
                      :class="{ sending: isSending }"
                      :disabled="isSending"
                    >
                      {{ isSending ? 'SENDING...' : 'SEND' }}
                    </button>
                  </li>
                </ul>
              </form>
            </div>
          </div>
        </div>

        <!-- Map Section -->
        <div class="map-section">
          <!-- Info Box -->
          <div class="info-map">
            Emma Huber
            <br />
            Charlotte/Raleigh, NC
            <br />
            United States
            <br />
            <br />
            <span>emhuber112@gmail.com</span>
          </div>

          <!-- Map -->
          <div class="map-wrap" id="map"></div>
        </div>
      </div>
    </div>

    <script src="../petite-vue.iife.js" defer init></script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@3/dist/email.min.js"></script>
    <script>
      function contactApp() {
        return {
          isSending: false,
          formData: {
            name: "",
            email: "",
            subject: "",
            message: "",
          },

          async sendEmail() {
            this.isSending = true;

            // Initialize EmailJS (replace with your actual IDs)
            emailjs.init("MWlWsi74FQUm14Z_r");

            try {
              await emailjs.send("service_eddn63z", "template_k0c955j", {
                from_name: this.formData.name,
                from_email: this.formData.email,
                subject: this.formData.subject,
                message: this.formData.message,
              });

              alert("Message successfully sent!");
              // Reset form
              this.formData = {
                name: "",
                email: "",
                subject: "",
                message: "",
              };
            } catch (error) {
              console.error("EmailJS Error:", error);
              alert("Failed to send the message, please try again.");
            } finally {
              this.isSending = false;
            }
          },
        };
      }

      // Initialize map after page loads
      window.addEventListener("DOMContentLoaded", () => {
        setTimeout(() => {
          const mapElement = document.getElementById("map");
          if (mapElement && typeof L !== "undefined") {
            const map = L.map("map").setView(
              [35.783921433385075, -78.67094276937735],
              13,
            );

            L.tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png", {
              attribution: "Â© OpenStreetMap contributors",
            }).addTo(map);

            L.marker([35.783921433385075, -78.67094276937735])
              .addTo(map)
              .bindPopup("Raleigh, NC")
              .openPopup();
          }
        }, 500);
      });
    </script>
  </body>
</html>
